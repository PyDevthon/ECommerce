{% extends 'base.html' %}
{% load static %}
{% load bootstrap_pagination %}
{% load Tags %}

{% block body %}

  <--Carousel Wrapper-->
  <div id="carousel-example-1z" class="carousel slide carousel-fade pt-4" data-ride="carousel">

    <!--Indicators-->
    <ol class="carousel-indicators">
      <li data-target="#carousel-example-1z" data-slide-to="0" class="active"></li>
      <li data-target="#carousel-example-1z" data-slide-to="1"></li>
      <li data-target="#carousel-example-1z" data-slide-to="2"></li>
    </ol>
    <!--/.Indicators-->

    <!--Slides-->
    <div class="carousel-inner" role="listbox">

      <!--First slide-->
      <div class="carousel-item active">
        <div class="view" style="background-image: url('{% static 'images/Image1.jpg' %}'); background-repeat: no-repeat; background-size: cover;">

          <!-- Mask & flexbox options-->
          <div class="mask rgba-black-strong d-flex justify-content-center align-items-center">

            <!-- Content -->
            <div class="text-center white-text mx-5 wow fadeIn">
              <h1 class="mb-4">
                <strong>Learn Bootstrap 4 with MDB</strong>
              </h1>

              <p>
                <strong>Best & free guide of responsive web design</strong>
              </p>

              <p class="mb-4 d-none d-md-block">
                <strong>The most comprehensive tutorial for the Bootstrap 4. Loved by over 500 000 users. Video and written versions
                  available. Create your own, stunning website.</strong>
              </p>

              <a target="_blank" href="https://mdbootstrap.com/bootstrap-tutorial/" class="btn btn-outline-white btn-lg">Start free tutorial
                <i class="fa fa-graduation-cap ml-2"></i>
              </a>
            </div>
            <!-- Content -->

          </div>
          <!-- Mask & flexbox options-->

        </div>
      </div>
      <!--/First slide-->

      <!--Second slide-->
      <div class="carousel-item">
        <div class="view" style="background-image: url('{% static 'images/Image2.jpg' %}'); background-repeat: no-repeat; background-size: cover;">

          <!-- Mask & flexbox options-->
          <div class="mask rgba-black-strong d-flex justify-content-center align-items-center">

            <!-- Content -->
            <div class="text-center white-text mx-5 wow fadeIn">
              <h1 class="mb-4">
                <strong>Learn Bootstrap 4 with MDB</strong>
              </h1>

              <p>
                <strong>Best & free guide of responsive web design</strong>
              </p>

              <p class="mb-4 d-none d-md-block">
                <strong>The most comprehensive tutorial for the Bootstrap 4. Loved by over 500 000 users. Video and written versions
                  available. Create your own, stunning website.</strong>
              </p>

              <a target="_blank" href="https://mdbootstrap.com/bootstrap-tutorial/" class="btn btn-outline-white btn-lg">Start free tutorial
                <i class="fa fa-graduation-cap ml-2"></i>
              </a>
            </div>
            <!-- Content -->

          </div>
          <!-- Mask & flexbox options-->

        </div>
      </div>
      <!--/Second slide-->

      <!--Third slide-->
      <div class="carousel-item">
        <div class="view" style="background-image: url('{% static 'images/Image3.jpg' %}'); background-repeat: no-repeat; background-size: cover;">

          <!-- Mask & flexbox options-->
          <div class="mask rgba-black-strong d-flex justify-content-center align-items-center">

            <!-- Content -->
            <div class="text-center white-text mx-5 wow fadeIn">
              <h1 class="mb-4">
                <strong>Learn Bootstrap 4 with MDB</strong>
              </h1>

              <p>
                <strong>Best & free guide of responsive web design</strong>
              </p>

              <p class="mb-4 d-none d-md-block">
                <strong>The most comprehensive tutorial for the Bootstrap 4. Loved by over 500 000 users. Video and written versions
                  available. Create your own, stunning website.</strong>
              </p>

              <a target="_blank" href="https://mdbootstrap.com/bootstrap-tutorial/" class="btn btn-outline-white btn-lg">Start free tutorial
                <i class="fa fa-graduation-cap ml-2"></i>
              </a>
            </div>
            <!-- Content -->

          </div>
          <!-- Mask & flexbox options-->

        </div>
      </div>
      <!--/Third slide-->

    </div>
    <!--/.Slides-->

    <!--Controls-->
    <a class="carousel-control-prev" href="#carousel-example-1z" role="button" data-slide="prev">
      <span class="carousel-control-prev-icon" aria-hidden="true"></span>
      <span class="sr-only">Previous</span>
    </a>
    <a class="carousel-control-next" href="#carousel-example-1z" role="button" data-slide="next">
      <span class="carousel-control-next-icon" aria-hidden="true"></span>
      <span class="sr-only">Next</span>
    </a>
    <!--/.Controls-->

  </div>
  <!--/.Carousel Wrapper-->

  <!--Main layout-->
  <main>
    <div class="container">

      <!--Navbar-->

    <nav class="navbar navbar-expand-lg navbar-dark mdb-color lighten-3 mt-3 mb-5">
  <form class="form-inline" action="" method="get">
       <div class="form-group pr-5">
  <label for="sel1" class="pr-3"><strong>Category: </strong></label>
  <select class="form-control" name="category" id="sel1">
  <option value="" selected>Select a Value</option>
        {% for choice in categories %}
        <option value="{{ choice.0 }}">{{ choice.1 }}</option>
    {% endfor %}
  </select>
</div>
    <input class="form-control mr-sm-2" name="query" type="text" placeholder="Search Query">
    <button class="btn btn-success" type="submit">Search</button>
  </form>
</nav>

      <!--/.Navbar-->

      <!--Section: Products v.3-->
       <h3 class="d-flex justify-content-center">Plot</h3>
      <div class="container d-flex justify-content-center">
      <span style="display:inline;" class="mx-auto">
<button class="btn btn-primary" id="login-form">Click to Plot</button>
       <button class="btn btn-primary" id="hide">Click to hide</button>
</div>
        </span>
 <div id="bokeh">

 </div>
    <div class="container">
      <div class="row">

        {% for product in products %}
            <!--Card-->
            	<div class="col-sm-4">
          <div class="card" onclick="location.href='{% url 'Item_Detail' product.id%}';" style="cursor:pointer;">
  <img class="card-img-top" src="/{{ product.image_set.all|img }}" alt="Card image">
 <div class="card-body text-center">
                <!--Category & Title-->
                <a href="" class="grey-text">
                  <h5>{{ product.category }}</h5>
                </a>
                <h5>
                  <strong>
                    <a href="" class="dark-grey-text">{% length product.name 18 %}
                    </a>
                  </strong>
                </h5>

                <h4 class="font-weight-bold blue-text">
                  <strong>Rs. {{ product.price }}</strong>
                </h4>
  </div>
</div>
            <!--Card-->

          </div>
          <!--Grid column-->
            {% endfor %}
        </div>

</div>
      <!--Section: Products v.3-->

      <!--Pagination-->
<div class="container mt-5">
{% bootstrap_paginate page_obj range=9 %}
</div>
    </div>
    <script type="text/javascript">

            // Submit post on submit
$('#login-form').on('click', function(event){
    event.preventDefault();
    console.log("checking Plot!")  // sanity check
    if ($("#bokeh").find(".bk-root").length > 0){

    $("#bokeh").show();
    console.log("Plot exits");

    }else {

    console.log("Creating Plot");
    create_plot();

    }

});

function create_plot() {
    console.log("Making Request") // sanity check
    $.ajax({
        url : "{% url 'Bokeh' %}", // the endpoint
        type : "get", // http method
       // data sent with the post request

        // handle a successful response
        success : function(data) {
            console.log("success"); // another sanity check
            $('#bokeh').html(data["div"])
            $('head').append(data["script"])

        },

        // handle a non-successful response
        error : function(xhr,errmsg,err) {
            console.log("something went wrong");


        }
    });
};

    </script>
    <script type="text/javascript">

      $('#hide').click(function (){

    if ($("#bokeh").find(".bk-root").length > 0){

    $("#bokeh").hide();
    console.log("Plot Hidden");

    }

      }

      );

    </script>
  </main>


{% endblock %}